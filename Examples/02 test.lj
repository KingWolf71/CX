/* =============================================================================
   LJ2 Crash Test
   
   ============================================================================= */

#pragma appname "LJ2 Crash Test"
#pragma console on
#pragma optimizecode on
#pragma ListASM on
#pragma version




/* =============================================================================
   SECTION 16: OPTIMIZATION TESTS
   ============================================================================= */
print("SECTION 16: Optimization Tests");
print("------------------------------");

// Constant folding
constFold1 = 10 + 5;
print("Const fold (10+5): ", constFold1, " (expected: 15)");

constFold2 = 20 * 3;
print("Const fold (20*3): ", constFold2, " (expected: 60)");

// Identity optimization
identX = 42;
identAdd = identX + 0;
print("Identity (x+0): ", identAdd, " (expected: 42)");

identMul = identX * 1;
print("Identity (x*1): ", identMul, " (expected: 42)");

identSub = identX - 0;
print("Identity (x-0): ", identSub, " (expected: 42)");

identDiv = identX / 1;
print("Identity (x/1): ", identDiv, " (expected: 42)");

identZero = identX * 0;
print("Identity (x*0): ", identZero, " (expected: 0)");

// Works well till here

/* =============================================================================
   SECTION 17: REAL-WORLD ALGORITHMS
   ============================================================================= */
print("SECTION 17: Real-world Algorithms");
print("---------------------------------");

// GCD (Greatest Common Divisor)
func gcd(a, b) {
    while (b != 0) {
        temp = b;
        b = a % b;
        a = temp;
    }
    return a;
}

gcdResult = gcd(48, 18);
print("GCD(48, 18): ", gcdResult, " (expected: 6)");

// Prime checker
func isPrime(n) {
    if (n <= 1) {
        return 0;
    }
    if (n == 2) {
        return 1;
    }
    i = 2;
    while (i * i <= n) {
        if (n % i == 0) {
            return 0;
        }
        i = i + 1;
    }
    return 1;
}

prime17 = isPrime(17);
print("isPrime(17): ", prime17, " (expected: 1)");

prime18 = isPrime(18);
print("isPrime(18): ", prime18, " (expected: 0)");

// Power function
func power(base, exp) {
    if (exp == 0) {
        return 1;
    }
    result = 1;
    i = 0;
    while (i < exp) {
        result = result * base;
        i = i + 1;
    }
    return result;
}

pow2_10 = power(2, 10);
print("power(2, 10): ", pow2_10, " (expected: 1024)");

pow3_4 = power(3, 4);
print("power(3, 4): ", pow3_4, " (expected: 81)");

/* =============================================================================
   FINAL SUMMARY
   ============================================================================= */
print("COMPREHENSIVE TEST SUITE COMPLETE");
print("---------------------------------");
print("All sections executed successfully!");
print("Verify output matches expected values.");
